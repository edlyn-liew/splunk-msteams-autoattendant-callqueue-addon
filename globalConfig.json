{
    "pages": {
        "configuration": {
            "tabs": [
                {
                    "name": "account",
                    "table": {
                        "actions": [
                            "edit",
                            "delete",
                            "clone"
                        ],
                        "header": [
                            {
                                "label": "Name",
                                "field": "name"
                            }
                        ]
                    },
                    "entity": [
                        {
                            "type": "text",
                            "label": "Name",
                            "validators": [
                                {
                                    "type": "regex",
                                    "errorMsg": "Account Name must begin with a letter and consist exclusively of alphanumeric characters and underscores.",
                                    "pattern": "^[a-zA-Z]\\w*$"
                                },
                                {
                                    "type": "string",
                                    "errorMsg": "Length of input name should be between 1 and 100",
                                    "minLength": 1,
                                    "maxLength": 100
                                }
                            ],
                            "field": "name",
                            "help": "A unique name for the account.",
                            "required": true
                        },
                        {
                            "type": "text",
                            "label": "Email",
                            "field": "email",
                            "help": "Email account for authentication",
                            "required": true,
                            "validators": [
                                {
                                    "type": "email",
                                    "errorMsg": "Please enter a valid email address"
                                },
                                {
                                    "type": "string",
                                    "errorMsg": "Length of email should be between 1 and 200",
                                    "minLength": 1,
                                    "maxLength": 200
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "label": "Password",
                            "field": "password",
                            "help": "Password for the email account",
                            "required": true,
                            "encrypted": true,
                            "validators": [
                                {
                                    "type": "string",
                                    "errorMsg": "Password is required",
                                    "minLength": 1,
                                    "maxLength": 200
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "label": "Tenant ID",
                            "field": "tenant_id",
                            "help": "Microsoft Azure Tenant ID for OAuth authentication",
                            "required": true,
                            "validators": [
                                {
                                    "type": "string",
                                    "errorMsg": "Tenant ID is required",
                                    "minLength": 1,
                                    "maxLength": 200
                                }
                            ]
                        }
                    ],
                    "title": "Accounts"
                },
                {
                    "type": "loggingTab"
                }
            ],
            "title": "Configuration",
            "description": "Set up your add-on"
        },
        "inputs": {
            "services": [
                {
                    "name": "vaac_analytics",
                    "entity": [
                        {
                            "type": "text",
                            "label": "Name",
                            "validators": [
                                {
                                    "type": "regex",
                                    "errorMsg": "Input Name must begin with a letter and consist exclusively of alphanumeric characters and underscores.",
                                    "pattern": "^[a-zA-Z]\\w*$"
                                },
                                {
                                    "type": "string",
                                    "errorMsg": "Length of input name should be between 1 and 100",
                                    "minLength": 1,
                                    "maxLength": 100
                                }
                            ],
                            "field": "name",
                            "help": "A unique name for the data input.",
                            "required": true
                        },
                        {
                            "type": "interval",
                            "label": "Interval",
                            "defaultValue": "300",
                            "field": "interval",
                            "options": {
                                "range": [
                                    10,
                                    31536000
                                ]
                            },
                            "help": "Time interval of the data input, in seconds.",
                            "required": true
                        },
                        {
                            "type": "index",
                            "field": "index",
                            "label": "Index"
                        },
                        {
                            "type": "singleSelect",
                            "label": "Account to use",
                            "options": {
                                "referenceName": "account"
                            },
                            "help": "Account to use for this input.",
                            "field": "account",
                            "required": true,
                            "validators": [
                                {
                                    "type": "string",
                                    "errorMsg": "Length of account name should be between 1 and 100",
                                    "minLength": 1,
                                    "maxLength": 100
                                }
                            ]
                        },
                        {
                            "type": "checkboxTree",
                            "label": "Dimensions",
                            "field": "dimensions",
                            "help": {
                                "text": "Select dimensions to group and filter your data.\nDimensions include Auto Attendant and Call Queue fields.\nSee [[dimensions_docs]] for detailed field descriptions.",
                                "links": [{
                                    "slug": "dimensions_docs",
                                    "link": "https://learn.microsoft.com/en-us/microsoftteams/aa-cq-cqd-historical-reports#auto-attendant-dimensions",
                                    "linkText": "Microsoft Teams VAAC Dimensions Documentation"
                                }]
                            },
                            "required": true,
                            "options": {
                                "groups": [
                                    {
                                        "label": "Auto Attendant Dimensions",
                                        "options": {
                                            "isExpandable": true,
                                            "expand": true
                                        },
                                        "fields": ["AutoAttendantIdentity", "AutoAttendantCallFlow", "AutoAttendantCallResult", "AutoAttendantCallerActionCounts", "AutoAttendantChainDurationInSecs", "AutoAttendantChainIndex", "AutoAttendantChainStartTime", "AutoAttendantCount", "AutoAttendantDirectorySearchMethod", "AutoAttendantId", "AutoAttendantTransferAction", "HasAA"]
                                    },
                                    {
                                        "label": "Call Queue Dimensions",
                                        "options": {
                                            "isExpandable": true,
                                            "expand": true
                                        },
                                        "fields": ["CallQueueIdentity", "CallQueueAgentCount", "CallQueueAgentOptInCount", "CallQueueCallResult", "CallQueueDurationSeconds", "CallQueueFinalStateAction", "CallQueueId", "CallQueueTargetType", "HasCQ", "TransferredFromCQId", "TransferredFromCallQueueIdentity"]
                                    }
                                ],
                                "rows": [
                                    {
                                        "field": "AutoAttendantIdentity",
                                        "checkbox": {
                                            "label": "AutoAttendantIdentity - Resource account URI",
                                            "defaultValue": true
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantCallFlow",
                                        "checkbox": {
                                            "label": "AutoAttendantCallFlow - Call flow states"
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantCallResult",
                                        "checkbox": {
                                            "label": "AutoAttendantCallResult - Final call outcomes"
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantCallerActionCounts",
                                        "checkbox": {
                                            "label": "AutoAttendantCallerActionCounts - Number of caller actions"
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantChainDurationInSecs",
                                        "checkbox": {
                                            "label": "AutoAttendantChainDurationInSecs - Call flow duration"
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantChainIndex",
                                        "checkbox": {
                                            "label": "AutoAttendantChainIndex - Call chain segment index"
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantChainStartTime",
                                        "checkbox": {
                                            "label": "AutoAttendantChainStartTime - Call flow start time"
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantCount",
                                        "checkbox": {
                                            "label": "AutoAttendantCount - Number of AAs traversed"
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantDirectorySearchMethod",
                                        "checkbox": {
                                            "label": "AutoAttendantDirectorySearchMethod - Search method"
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantId",
                                        "checkbox": {
                                            "label": "AutoAttendantId - AA GUID"
                                        }
                                    },
                                    {
                                        "field": "AutoAttendantTransferAction",
                                        "checkbox": {
                                            "label": "AutoAttendantTransferAction - Transfer target type"
                                        }
                                    },
                                    {
                                        "field": "HasAA",
                                        "checkbox": {
                                            "label": "HasAA - Is AA involved in call"
                                        }
                                    },
                                    {
                                        "field": "CallQueueIdentity",
                                        "checkbox": {
                                            "label": "CallQueueIdentity - Resource account URI",
                                            "defaultValue": true
                                        }
                                    },
                                    {
                                        "field": "CallQueueAgentCount",
                                        "checkbox": {
                                            "label": "CallQueueAgentCount - Number of agents in queue"
                                        }
                                    },
                                    {
                                        "field": "CallQueueAgentOptInCount",
                                        "checkbox": {
                                            "label": "CallQueueAgentOptInCount - Number of opted-in agents"
                                        }
                                    },
                                    {
                                        "field": "CallQueueCallResult",
                                        "checkbox": {
                                            "label": "CallQueueCallResult - Final call state"
                                        }
                                    },
                                    {
                                        "field": "CallQueueDurationSeconds",
                                        "checkbox": {
                                            "label": "CallQueueDurationSeconds - Duration in queue"
                                        }
                                    },
                                    {
                                        "field": "CallQueueFinalStateAction",
                                        "checkbox": {
                                            "label": "CallQueueFinalStateAction - Final action"
                                        }
                                    },
                                    {
                                        "field": "CallQueueId",
                                        "checkbox": {
                                            "label": "CallQueueId - Call Queue GUID"
                                        }
                                    },
                                    {
                                        "field": "CallQueueTargetType",
                                        "checkbox": {
                                            "label": "CallQueueTargetType - Call redirection target"
                                        }
                                    },
                                    {
                                        "field": "HasCQ",
                                        "checkbox": {
                                            "label": "HasCQ - Is CQ involved in call"
                                        }
                                    },
                                    {
                                        "field": "TransferredFromCQId",
                                        "checkbox": {
                                            "label": "TransferredFromCQId - Source queue GUID"
                                        }
                                    },
                                    {
                                        "field": "TransferredFromCallQueueIdentity",
                                        "checkbox": {
                                            "label": "TransferredFromCallQueueIdentity - Source queue URI"
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "type": "checkboxTree",
                            "label": "Measurements",
                            "field": "measurements",
                            "help": {
                                "text": "Select measurements (metrics) to retrieve from the VAAC API.\nAt least one measurement must be selected.\nSee [[measurements_docs]] for detailed metric descriptions.",
                                "links": [{
                                    "slug": "measurements_docs",
                                    "link": "https://learn.microsoft.com/en-us/microsoftteams/aa-cq-cqd-historical-reports#measurements",
                                    "linkText": "Microsoft Teams VAAC Measurements Documentation"
                                }]
                            },
                            "required": true,
                            "options": {
                                "groups": [
                                    {
                                        "label": "Auto Attendant Measurements",
                                        "options": {
                                            "isExpandable": true,
                                            "expand": true
                                        },
                                        "fields": ["AvgAutoAttendantChainDurationSeconds"]
                                    },
                                    {
                                        "label": "Call Queue Measurements",
                                        "options": {
                                            "isExpandable": true,
                                            "expand": true
                                        },
                                        "fields": ["AvgCallDuration", "AvgCallQueueDurationSeconds"]
                                    },
                                    {
                                        "label": "General Measurements",
                                        "options": {
                                            "isExpandable": true,
                                            "expand": true
                                        },
                                        "fields": ["PSTNTotalMinutes", "TotalCallCount", "TotalAudioStreamDuration"]
                                    }
                                ],
                                "rows": [
                                    {
                                        "field": "AvgAutoAttendantChainDurationSeconds",
                                        "checkbox": {
                                            "label": "AvgAutoAttendantChainDurationSeconds - Avg AA call flow duration"
                                        }
                                    },
                                    {
                                        "field": "AvgCallDuration",
                                        "checkbox": {
                                            "label": "AvgCallDuration - Avg total call duration"
                                        }
                                    },
                                    {
                                        "field": "AvgCallQueueDurationSeconds",
                                        "checkbox": {
                                            "label": "AvgCallQueueDurationSeconds - Avg queue duration"
                                        }
                                    },
                                    {
                                        "field": "PSTNTotalMinutes",
                                        "checkbox": {
                                            "label": "PSTNTotalMinutes - Total PSTN call minutes",
                                            "defaultValue": true
                                        }
                                    },
                                    {
                                        "field": "TotalCallCount",
                                        "checkbox": {
                                            "label": "TotalCallCount - Total number of calls",
                                            "defaultValue": true
                                        }
                                    },
                                    {
                                        "field": "TotalAudioStreamDuration",
                                        "checkbox": {
                                            "label": "TotalAudioStreamDuration - Total audio stream duration"
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "type": "text",
                            "label": "Limit Result Rows",
                            "field": "limit_result_rows",
                            "help": "Maximum number of rows to return (max: 200000)",
                            "required": false,
                            "defaultValue": "200000",
                            "validators": [
                                {
                                    "type": "number",
                                    "range": [1, 200000],
                                    "errorMsg": "Must be a number between 1 and 200000"
                                }
                            ]
                        }
                    ],
                    "title": "VAAC Analytics",
                    "inputHelperModule": "input_helper"
                }
            ],
            "title": "Inputs",
            "description": "Manage your data inputs",
            "table": {
                "actions": [
                    "edit",
                    "delete",
                    "clone"
                ],
                "header": [
                    {
                        "label": "Name",
                        "field": "name"
                    },
                    {
                        "label": "Interval",
                        "field": "interval"
                    },
                    {
                        "label": "Index",
                        "field": "index"
                    },
                    {
                        "label": "Status",
                        "field": "disabled"
                    }
                ],
                "moreInfo": [
                    {
                        "label": "Name",
                        "field": "name"
                    },
                    {
                        "label": "Interval",
                        "field": "interval"
                    },
                    {
                        "label": "Index",
                        "field": "index"
                    },
                    {
                        "label": "Status",
                        "field": "disabled",
                        "mapping": {
                            "true": "Inactive",
                            "false": "Active"
                        }
                    }
                ]
            }
        },
        "dashboard": {
            "panels": [
                {
                    "name": "default"
                }
            ]
        }
    },
    "meta": {
        "name": "splunk_msteams_aa_callqueue_reporting_addon",
        "restRoot": "splunk_msteams_aa_callqueue_reporting_addon",
        "version": "1.0.1",
        "displayName": "MSTeams Auto Attendant and Call Queue Reporting Add-on for Splunk",
        "schemaVersion": "0.0.10",
        "supportedThemes": [
            "light",
            "dark"
        ]
    }
}
